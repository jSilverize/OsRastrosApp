"use strict";angular.module("rastros",["ngRoute","duScroll","aphrodite"]),angular.module("rastros").config(["$routeProvider","momentProvider",function(a,e){e.locale("pt-br"),a.when("/",{templateUrl:"app/templates/home-template.html",controller:"HomeController",authPage:!1,authenticated:!1}).when("/404",{templateUrl:"app/templates/404-template.html",controller:"404Controller",authPage:!1,authenticated:!1}).when("/entrar",{templateUrl:"app/templates/auth-login-template.html",controller:"AuthController",authPage:!0,authenticated:!1}).when("/cadastrar",{templateUrl:"app/templates/auth-register-template.html",controller:"AuthController",authPage:!0,authenticated:!1}).when("/perfil",{templateUrl:"app/templates/profile-template.html",controller:"ProfileController",authPage:!1,authenticated:!0}).when("/jogos/:dateId/:gameId",{templateUrl:"app/templates/game-template.html",controller:"GameController",authPage:!1,authenticated:!0,resolve:{gameResolved:["$route","fireb",function(a,e){var t=a.current.params.dateId,r=a.current.params.gameId;return t&&r||console.log("tá errado"),e.games.get(t,r)}]}}).otherwise({redirectTo:"/404"})}]),angular.module("rastros").run(["$rootScope","routeChange","flow",function(a,e,t){a.$on("$routeChangeError",e.error),a.$on("$routeChangeStart",e.start),a.$on("$routeChangeSuccess",e.success),t.ls.getItem("lastPath")||t.ls.setItem("lastPath","/"),alertify.set({labels:{ok:"SIM",cancel:"NÃO"},buttonReverse:!0,buttonFocus:"cancel"})}]),function(){angular.module("rastros").run(["$templateCache",function(a){a.put("app/templates/404-template.html",' <header class="header"> <div class="aph container"> <h1 class="header__title aph support text-center"> 404 </h1> </div> </header> <section class="section"> <div class="container"> <h1 class="aph section__title"> Caminho ou página não encontrada </h1> <p class="aph"> Você tentou acessar algo que não tá aqui com nóis não, fi. </p> <p class="aph"> Pode tentar de novo, se quiser. </p> <br> <button class="aph btn btn--black" data-ng-click="goBack();"> Voltar </button> </div> </section>'),a.put("app/templates/auth-login-template.html",' <header class="header"> <div class="aph container"> <h1 class="header__title aph support text-center"> Entrar </h1> </div> </header> <section class="section"> <div class="aph container"> <div class="row center-xs center-sm center-md center-lg"> <div class="col-xs-12 col-sm-5 col-md-4 col-lg-3"> <form class="aph form form--with-fields" name="loginForm" novalidate data-form-validation="loginForm" data-ng-submit="loginForm.$valid && login();"> <div class="aph form__field form__field--large"> <button class="aph btn btn--block btn--facebook" type="button" data-ng-click="facebook();"> ENTRAR COM FACEBOOK </button> </div> <div class="aph form__field form__field--large"> <button class="aph btn btn--block btn--twitter" type="button" data-ng-click="twitter();"> ENTRAR COM TWITTER </button> </div> <div class="aph form__field form__field--large form__or text-center"> OU ENTÃO </div> <div class="aph form__field"> <label class="aph form__label" for="email"> E-mail* </label> <input class="aph form__control" type="email" name="email" id="email" data-ng-required="true" data-ng-model="form.email"> <div class="aph form__helper form__helper--error" data-ng-show="loginForm[\'email\'].$invalid && !loginForm[\'email\'].$pristine"> Preencha com um e-mail válido </div> </div> <div class="aph form__field"> <label class="aph form__label" for="password"> Senha* </label> <input class="aph form__control" type="password" name="password" id="password" data-ng-required="true" data-ng-model="form.password"> <div class="aph form__helper form__helper--error" data-ng-show="loginForm[\'password\'].$invalid && !loginForm[\'password\'].$pristine"> Insira sua senha </div> </div> <div class="aph form__field form__field--large"> <button class="aph btn btn--block btn--green" type="submit" data-ng-disabled="!form.email || !form.password"> ENTRAR </button> </div> <div class="aph form__field form__field--large"> <button class="aph btn btn--block btn--bordered btn--yellow" type="button" data-ng-disabled="loginForm[\'email\'].$invalid || sentResetPassowrd" data-ng-click="forgetPassword(); sentResetPassowrd = true;"> ESQUECI A SENHA </button> </div> </form> </div> </div> </div> </section>'),a.put("app/templates/auth-register-template.html",' <header class="header"> <div class="aph container"> <h1 class="header__title aph support text-center"> Cadastrar </h1> </div> </header> <section class="section"> <div class="aph container"> <div class="row center-xs center-sm center-md center-lg"> <div class="col-xs-12 col-sm-5 col-md-4 col-lg-3"> <form class="aph form form--with-fields" name="registerForm" novalidate data-form-validation="registerForm" data-ng-submit="registerForm.$valid && register();"> <div class="aph form__field form__field--large"> <button class="aph btn btn--block btn--facebook" type="button" data-ng-click="facebook()"> CADASTRAR COM FACEBOOK </button> </div> <div class="aph form__field form__field--large"> <button class="aph btn btn--block btn--twitter" type="button" data-ng-click="twitter()"> CADASTRAR COM TWITTER </button> </div> <div class="aph form__field form__field--large form__or text-center"> OU ENTÃO </div> <div class="aph form__field"> <label class="aph form__label" for="email"> E-mail* </label> <input class="aph form__control" type="email" name="email" id="email" data-ng-required="true" data-ng-model="form.email" autocomplete="off"> <div class="aph form__helper form__helper--error" data-ng-show="registerForm[\'email\'].$invalid && !registerForm[\'email\'].$pristine"> Preencha com um e-mail válido </div> </div> <div class="aph form__field"> <label class="aph form__label" for="emailCheck"> Confirmar Email* </label> <input class="aph form__control" type="email" name="emailCheck" id="emailCheck" data-ng-match="form.email" data-ng-required="true" data-ng-model="form.emailCheck" autocomplete="off"> <div class="aph form__helper form__helper--error" data-ng-show="registerForm[\'emailCheck\'].$invalid && !registerForm[\'emailCheck\'].$pristine"> Repita o e-mail correspondente </div> <div class="aph form__helper form__helper--error" data-ng-show="registerForm[\'email\'].$valid && form.email !== form.emailCheck && !registerForm[\'emailCheck\'].$pristine && registerForm[\'emailCheck\'].$valid"> Os e-mails não estão iguais </div> </div> <div class="aph form__field"> <label class="aph form__label" for="password"> Senha* </label> <input class="aph form__control" type="password" name="password" id="password" data-ng-required="true" data-ng-model="form.password"> <div class="aph form__helper form__helper--error" data-ng-show="registerForm[\'password\'].$invalid && !registerForm[\'password\'].$pristine"> Insira uma senha </div> </div> <div class="aph form__field"> <label class="aph form__label" for="passwordCheck"> Confirmar Senha* </label> <input class="aph form__control" type="password" name="passwordCheck" id="passwordCheck" data-ng-match="form.password" data-ng-required="true" data-ng-model="form.passwordCheck"> <div class="aph form__helper form__helper--error" data-ng-show="registerForm[\'passwordCheck\'].$invalid && !registerForm[\'passwordCheck\'].$pristine"> Repita a senha correspondente </div> <div class="aph form__helper form__helper--error" data-ng-show="registerForm[\'password\'].$valid && form.password !== form.passwordCheck && !registerForm[\'passwordCheck\'].$pristine && registerForm[\'passwordCheck\'].$valid"> A senha não está igual </div> </div> <div class="aph form__field form__field--large"> <button class="aph btn btn--block btn--green" type="submit" data-ng-disabled="!form.email || !form.password || !form.passwordCheck || form.password !== form.passwordCheck || registerForm.$submitted"> CADASTRAR </button> </div> </form> </div> </div> </div> </section> '),a.put("app/templates/game-template.html",' <header class="header"> <div class="aph container"> <h1 class="header__title aph support text-center"> Súmula do Jogo </h1> </div> </header> <section class="section"> <div class="aph container"> <div class="game"> <div class="match__date"> <div class="match__date__weekday"> {{ game.date.moment.format(\'dddd\') }} </div> <div class="match__date__fulldate"> {{ game.date.moment.format(\'DD [de] MMMM [de] YYYY\') }} </div> <div class="match__date__time"> {{ game.date.moment.format(\'HH:mm\') }} </div> </div> <div class="match__teams"> <div class="match__team"> <img class="match__team__logo" data-ng-src="{{ game.teams.home.logo }}" data-error-src="{{ game.teams.home.logoOld }}"> {{ game.teams.home.title }} </div> <div class="match__versus">×</div> <div class="match__team"> <img class="match__team__logo" data-ng-src="{{ game.teams.visitor.logo }}" data-error-src="{{ game.teams.visitor.logoOld }}"> {{ game.teams.visitor.title }} </div> </div> </div> </div> </section> <div class="container"> <hr class="aph divider"> </div> <section class="section game__frame"> <div class="aph container"> <h3 class="aph section__title text-center"> Primeira Partida </h3> <div class="row aph text-center"> <div class="col-xs-5"> <div class="game__frame__score"> {{ game.teams.home.score.first.goals.length }} </div> </div> <div class="col-xs-2"> <h4 class="aph game__frame__title"> GOLS </h4> </div> <div class="col-xs-5"> <div class="game__frame__score"> {{ game.teams.visitor.score.first.goals.length }} </div> </div> </div> <div class="row"> <div class="col-xs-6"> <div class="aph text-right"> <button class="aph btn btn--small btn--bordered btn--green" type="button" data-ng-click="addGoal(\'home\', \'first\');"> <i class="fa fa-lg fa-plus-circle"></i> GOL </button> </div> </div> <div class="col-xs-6"> <div class="aph text-left"> <button class="aph btn btn--small btn--bordered btn--yellow" type="button" data-ng-click="addGoal(\'visitor\', \'first\');"> GOL <i class="fa fa-lg fa-plus-circle"></i> </button> </div> </div> </div> <div class="row"> <div class="col-xs-6"> <div class="aph text-right"> <div class="game__goals"> <div class="game__goal" data-ng-repeat="goal in game.score.first.home.goals" data-goal-index="{{ $index }}" data-on-long-press="removeGoal(\'home\', \'first\', $index);"> <a class="game__goal__remove" data-ng-click="removeGoal(\'home\', \'first\', $index);"> <i class="fa fa-fw fa-times"></i> </a> <span class="game__goal__player"> {{ goal.player.name }} <span class="game__goal__player__number" data-ng-show="goal.player.number"> {{ goal.player.number }} </span> </span> <span class="game__goal__time" data-ng-show="goal.time"> {{ goal.time }} </span> <i class="fa fa-fw fa-lg fa-futbol-o"></i> </div> </div> </div> </div> <div class="col-xs-6"> <div class="aph text-left"> <div class="game__goals"> <div class="game__goal" data-ng-repeat="goal in game.score.first.visitor.goals" data-goal-index="{{ $index }}" data-on-long-press="removeGoal(\'visitor\', \'first\', $index);"> <i class="fa fa-fw fa-lg fa-futbol-o"></i> <span class="game__goal__time" data-ng-show="goal.time"> {{ goal.time }} </span> <span class="game__goal__player"> <span class="game__goal__player__number" data-ng-show="goal.player.number"> {{ goal.player.number }} </span> {{ goal.player.name }} </span> <a class="game__goal__remove" data-ng-click="removeGoal(\'visitor\', \'first\', $index);"> <i class="fa fa-fw fa-times"></i> </a> </div> </div> </div> </div> </div> <div class="row" data-ng-show="game.teams.home.score.first.goals.length > 4 || game.teams.visitor.score.first.goals.length > 4"> <div class="col-xs-6"> <div class="aph text-right"> <button class="aph btn btn--small btn--bordered btn--green" type="button" data-ng-click="addGoal(\'home\', \'first\');"> <i class="fa fa-lg fa-plus-circle"></i> GOL </button> </div> </div> <div class="col-xs-6"> <div class="aph text-left"> <button class="aph btn btn--small btn--bordered btn--yellow" type="button" data-ng-click="addGoal(\'visitor\', \'first\');"> GOL <i class="fa fa-lg fa-plus-circle"></i> </button> </div> </div> </div> </div> </section>'),a.put("app/templates/home-template.html",'<header class="lion"> </header> <section class="section"> <div class="aph container" data-ng-if="nextMatches"> <h1 class="aph support"> <span data-ng-if="nextMatches"> Próximos Jogos </span> </h1> <div class="row center-sm center-md center-lg"> <div class="col-xs-12 col-sm-6 col-md-4" data-ng-repeat="match in nextMatches"> <div data-ng-init="goingCount(match)"></div> <div class="match"> <div class="match__date"> <div class="match__date__weekday"> {{ match.date.moment.format(\'dddd\') }} </div> <div class="match__date__fulldate"> {{ match.date.moment.format(\'DD [de] MMMM [de] YYYY\') }} </div> <div class="match__date__time"> {{ match.date.moment.format(\'HH:mm\') }} </div> </div> <div class="match__teams"> <div class="match__team"> <img class="match__team__logo" data-ng-src="{{ match.teams.home.logo }}" data-error-src="{{ match.teams.home.logoOld }}"> {{ match.teams.home.title }} </div> <div class="match__versus">×</div> <div class="match__team"> <img class="match__team__logo" data-ng-src="{{ match.teams.visitor.logo }}" data-error-src="{{ match.teams.visitor.logoOld }}"> {{ match.teams.visitor.title }} </div> </div> <div class="match__footer"> <div class="match__going"> <div class="match__going__text"> <ng-pluralize count="match.goingNumber" when="{\n\t\t\t\t\t\t\t\t\t\t\'0\'    : \'Ninguém confirmou ainda. Bora?\',\n\t\t\t\t\t\t\t\t\t\t\'one\'  : \'1 pessoa falou que vai, hein?!\',\n\t                     \t\t\t\t\'other\': \'{} pessoas confirmaram presença\'\n\t                     \t\t\t}"> </ng-pluralize> </div> <div class="match__going__users"> <img class="match__going__users__avatar" data-ng-repeat="people in match.goingProfiles" title="{{ people.name }}" alt="{{ people.name }}" data-ng-src="{{ people.photoURL }}" data-error-src="/assets/images/icons/icon-60x60.png"> <button class="match__going__users__avatar" data-ng-show="!match.goingProfiles || match.goingProfiles.length === 0" title="Confirmar presença?" data-ng-click="imGoing(match);"> <i class="fa fa-check-circle"></i> </button> </div> </div> <div class="row center-lg center-md center-sm center-xs"> <div class="col-xs-6"> <a class="aph btn btn--small btn--block btn--link btn--black" target="_blank" title="Ver no site da Futliga" href="{{ detailsUrl + match.date.id + \'/\' + match.id }}#confronto-mapa"> Local </a> </div> <div class="col-xs-6"> <button class="aph btn btn--small btn--block btn--link btn--green" data-ng-click="imGoing(match);" data-ng-show="!match.imGoing"> Vou colar! </button> <button class="aph btn btn--small btn--block btn--link btn--red" data-ng-click="imNotGoing(match);" data-ng-show="match.imGoing && user.uid"> Não vou + </button> </div> <!-- <div class="col-xs-12"\n\t\t\t\t\t\t\t\t data-ng-show="canFillGames && isToday(match);">\n\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t<button class="aph btn btn--small btn--block btn--yellow"\n\t\t\t\t\t\t\t\t   \t\tdata-ng-click="fillGame(match);">\n\t\t\t\t\t\t\t\t\tPreencher Súmula\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div> --> </div> </div> </div> </div> </div> </div> <div class="aph container" data-ng-if="!nextMatches"> <h1 class="aph support"> É, dom... </h1> <p class="aph"> Deu ruim tentando carregar os próximos jogos da futliga. </p> <p class="aph"> Mas acontece, falaê?! </p> </div> </section> '),a.put("app/templates/profile-template.html",'<header class="header header--no-mb"> <div class="aph container text-center"> <h1 class="aph header__title"> Meu perfil </h1> </div> </header> <section class="profile"> <div class="aph container"> <div class="row bottom-sm bottom-md bottom-lg"> <div class="col-xs-12 col-sm-2 col-md-1"> <figure class="profile__avatar"> <img class="profile__avatar__picture aph img-responsive" data-ng-src="{{ profile.photoURL }}" data-ng-if="profile.photoURL"> <img class="profile__avatar__picture aph img-responsive" data-ng-src="./assets/images/os-rastros.gif" data-ng-if="!profile.photoURL"> </figure> </div> <div class="col-xs-12 col-sm-4 col-md-4 col-lg-3 profile__info"> <div class="profile__info__item" title="{{ profile.displayName || profile.email }}"> <div class="profile__info__item__label"> <span data-ng-if="profile.displayName"> Nome </span> <span data-ng-if="!profile.displayName"> E-mail </span> </div> {{ profile.displayName || profile.email }} </div> </div> <div class="col-xs-12 col-sm-3 col-md-4 col-lg-6 profile__info"> <div class="profile__info__item" data-ng-if="profile.email && profile.displayName" title="{{ profile.email }}"> <div class="profile__info__item__label"> E-mail </div> {{ profile.email }} </div> </div> <div class="col-xs-12 col-sm-3 col-md-3 col-lg-2" title="EM CONSTRUÇÃO"> <!--<button class="aph btn btn--block btn--green"\n\t\t\t\t\t\ttype="button"\n\t\t\t\t\t\tdata-ng-click="edit();"\n\t\t\t\t\t\tdata-ng-disabled="true">\n\t\t\t\t\tEditar Perfil\n\t\t\t\t</button> --> </div> </div> </div> </section> '),a.put("app/templates/directives/loader-directive-template.html",'<div class="loader" data-ng-hide="activities.length === 0 && errors.length === 0"> <div class="loader__content"> <div class="venus container"> <figure class="loader__content__spinner" data-ng-show="activities.length !== 0 && errors.length === 0"> <img class="loader__content__spinner__image" data-ng-src="./assets/images/loader--spinner.gif" alt="Loading"> </figure> <div class="loader__content__message" data-ng-repeat="activity in activities"> <div data-ng-if="!activity.title && !activity.text" data-ng-bind-html="activity | unsafe"> </div> <div class="loader__content__message__title" data-ng-if="activity.title" data-ng-bind-html="activity.title | unsafe"> </div> <div class="loader__content__message__text" data-ng-if="activity.text" data-ng-bind-html="activity.text | unsafe"> </div> </div> <div class="loader__content__error" data-ng-repeat="error in errors"> <div data-ng-bind-html="error | unsafe"></div> <button class="loader__content__error__icon" data-ng-click="clearError(error)"> × </button> </div> </div> </div> </div> '),a.put("app/templates/directives/navbar-directive-template.html",'<div class="aph container"> <div class="aph navbar__nav"> <a class="aph navbar__brand" data-ng-click="goTo(\'/\');" title="Início"> <span class="aph navbar__brand__logo"></span> <span class="aph navbar__brand__title"> Os Rastros </span> </a> <ul class="aph navbar__menu navbar__menu--right list"> <li class="aph list__item" data-ng-if="!user"> <a class="aph list__item__link" data-ng-click="goTo(\'/cadastrar\')"> <i class="fa fa-fw fa-user-plus"></i> Cadastrar </a> </li> <li class="aph list__item" data-ng-if="!user"> <a class="aph btn btn--green" data-ng-click="goTo(\'/entrar\')"> <i class="fa fa-fw fa-sign-in"></i> Entrar </a> </li> <li class="aph list__item dropdown dropdown--right" data-ng-if="user" data-dropdown data-click-outside="closeDropdown();" aria-label="{{ user.displayName || user.email }}"> <img class="aph navbar__menu__user__avatar" height="32" width="32" alt="{{ user.displayName || user.email }}" data-ng-src="{{ user.photoURL || \'/assets/images/os-rastros.gif\' }}"> <a class="aph list__item__link navbar__menu__user dropdown__toggle"> {{ user.displayName || user.email }} </a> <ul class="aph dropdown__content"> <li class="aph dropdown__content__item"> <a class="aph dropdown__content__item__link" data-ng-click="goTo(\'/perfil\');"> <i class="fa fa-fw fa-lg fa-user"></i> Meu Perfil </a> </li> <li class="aph dropdown__content__item"> <a class="aph dropdown__content__item__link" data-ng-click="logout();"> <i class="fa fa-fw fa-lg fa-sign-out"></i> Sair </a> </li> </ul> </li> </ul> <label class="aph navbar__menu__drawer" for="drawer-default" data-drawer="drawer-default-menu"> <i class="fa fa-fw fa-bars"></i> <input class="aph navbar__menu__drawer__checkbox" type="checkbox" name="drawer-default" id="drawer-default" data-click-outside="closeDrawer();" data-outside-if-not="drawer-default-menu"> </label> </div> </div> <div class="aph drawer" id="drawer-default-menu"> <ul class="aph list drawer__menu"> <li class="aph list__header"> OS RASTROS </li> <li class="aph list__item"> <a class="aph list__item__link" data-ng-click="goTo(); closeDrawer();"> Início </a> </li> </ul> <ul class="aph list drawer__menu drawer__menu--user"> <li class="aph list__item text-black" data-ng-if="user"> <a class="aph list__item__link drawer__menu__user" data-ng-click="goTo(\'/perfil\'); closeDrawer();"> <img class="aph drawer__menu__user__avatar" height="32" width="32" alt="{{ user.displayName || user.email }}" data-ng-src="{{ user.photoURL || \'/assets/images/os-rastros.gif\' }}"> {{ user.displayName || user.email }} </a> </li> <li class="aph list__item"> <a class="aph btn btn--green btn--block btn--small" data-ng-click="goTo(\'/entrar\'); closeDrawer();" data-ng-if="!user"> <i class="fa fa-fw fa-sign-in"></i> ENTRAR </a> <a class="aph btn btn--green btn--block btn--bordered btn--small" data-ng-click="goTo(\'/cadastrar\'); closeDrawer();" data-ng-if="!user"> <i class="fa fa-fw fa-user-plus"></i> CADASTRAR </a> <a class="aph btn btn--green btn--small btn--bordered btn--block" data-ng-click="logout(); closeDrawer();" data-ng-if="user"> <i class="fa fa-fw fa-sign-out"></i> SAIR </a> </li> </ul> </div> '),a.put("app/templates/directives/loader-directive-template.html",'<div class="loader" data-ng-hide="activities.length === 0 && errors.length === 0"> <div class="loader__content"> <div class="venus container"> <figure class="loader__content__spinner" data-ng-show="activities.length !== 0 && errors.length === 0"> <img class="loader__content__spinner__image" data-ng-src="./assets/images/loader--spinner.gif" alt="Loading"> </figure> <div class="loader__content__message" data-ng-repeat="activity in activities"> <div data-ng-if="!activity.title && !activity.text" data-ng-bind-html="activity | unsafe"> </div> <div class="loader__content__message__title" data-ng-if="activity.title" data-ng-bind-html="activity.title | unsafe"> </div> <div class="loader__content__message__text" data-ng-if="activity.text" data-ng-bind-html="activity.text | unsafe"> </div> </div> <div class="loader__content__error" data-ng-repeat="error in errors"> <div data-ng-bind-html="error | unsafe"></div> <button class="loader__content__error__icon" data-ng-click="clearError(error)"> × </button> </div> </div> </div> </div> '),a.put("app/templates/directives/navbar-directive-template.html",'<div class="aph container"> <div class="aph navbar__nav"> <a class="aph navbar__brand" data-ng-click="goTo(\'/\');" title="Início"> <span class="aph navbar__brand__logo"></span> <span class="aph navbar__brand__title"> Os Rastros </span> </a> <ul class="aph navbar__menu navbar__menu--right list"> <li class="aph list__item" data-ng-if="!user"> <a class="aph list__item__link" data-ng-click="goTo(\'/cadastrar\')"> <i class="fa fa-fw fa-user-plus"></i> Cadastrar </a> </li> <li class="aph list__item" data-ng-if="!user"> <a class="aph btn btn--green" data-ng-click="goTo(\'/entrar\')"> <i class="fa fa-fw fa-sign-in"></i> Entrar </a> </li> <li class="aph list__item dropdown dropdown--right" data-ng-if="user" data-dropdown data-click-outside="closeDropdown();" aria-label="{{ user.displayName || user.email }}"> <img class="aph navbar__menu__user__avatar" height="32" width="32" alt="{{ user.displayName || user.email }}" data-ng-src="{{ user.photoURL || \'/assets/images/os-rastros.gif\' }}"> <a class="aph list__item__link navbar__menu__user dropdown__toggle"> {{ user.displayName || user.email }} </a> <ul class="aph dropdown__content"> <li class="aph dropdown__content__item"> <a class="aph dropdown__content__item__link" data-ng-click="goTo(\'/perfil\');"> <i class="fa fa-fw fa-lg fa-user"></i> Meu Perfil </a> </li> <li class="aph dropdown__content__item"> <a class="aph dropdown__content__item__link" data-ng-click="logout();"> <i class="fa fa-fw fa-lg fa-sign-out"></i> Sair </a> </li> </ul> </li> </ul> <label class="aph navbar__menu__drawer" for="drawer-default" data-drawer="drawer-default-menu"> <i class="fa fa-fw fa-bars"></i> <input class="aph navbar__menu__drawer__checkbox" type="checkbox" name="drawer-default" id="drawer-default" data-click-outside="closeDrawer();" data-outside-if-not="drawer-default-menu"> </label> </div> </div> <div class="aph drawer" id="drawer-default-menu"> <ul class="aph list drawer__menu"> <li class="aph list__header"> OS RASTROS </li> <li class="aph list__item"> <a class="aph list__item__link" data-ng-click="goTo(); closeDrawer();"> Início </a> </li> </ul> <ul class="aph list drawer__menu drawer__menu--user"> <li class="aph list__item text-black" data-ng-if="user"> <a class="aph list__item__link drawer__menu__user" data-ng-click="goTo(\'/perfil\'); closeDrawer();"> <img class="aph drawer__menu__user__avatar" height="32" width="32" alt="{{ user.displayName || user.email }}" data-ng-src="{{ user.photoURL || \'/assets/images/os-rastros.gif\' }}"> {{ user.displayName || user.email }} </a> </li> <li class="aph list__item"> <a class="aph btn btn--green btn--block btn--small" data-ng-click="goTo(\'/entrar\'); closeDrawer();" data-ng-if="!user"> <i class="fa fa-fw fa-sign-in"></i> ENTRAR </a> <a class="aph btn btn--green btn--block btn--bordered btn--small" data-ng-click="goTo(\'/cadastrar\'); closeDrawer();" data-ng-if="!user"> <i class="fa fa-fw fa-user-plus"></i> CADASTRAR </a> <a class="aph btn btn--green btn--small btn--bordered btn--block" data-ng-click="logout(); closeDrawer();" data-ng-if="user"> <i class="fa fa-fw fa-sign-out"></i> SAIR </a> </li> </ul> </div> ')}])}(),angular.module("rastros").constant("config",{FACEBOOK:{APP_ID:"100871850338155",SCOPE:"email,user_friends,user_birthday,user_location",SDK:"//connect.facebook.net/pt_BR/sdk.js",ERROR:{CODE:"fb-not-loaded",MSG:"Não foi possível carregar o serviço de autenticação do Facebook. Vamos tentar reestabelecer a conexão. Tente novamente em alguns segundos."}}}),angular.module("rastros").constant("urls",{CORS:"https://cors-anywhere.herokuapp.com/",FUTLIGA:{INDEX:"https://futliga.com.br/",IMAGES_PATH:"imagens/distintivos/",AGENDA_PATH:"Agenda/",NEXT_MATCHES:"futliga/associado/equipes/associado-equipes-obter-agenda.asp?hidEquipe=8985&hidPagina=1"}}),angular.module("rastros").factory("routeChange",["$rootScope","$document","$timeout","$location","flow","scroll","loader",function(a,e,t,r,o,i,s){var n={},l="Carregando...";return n.start=function(){s.start(l)},n.success=function(a,e){i.toTop(),firebase.auth().onAuthStateChanged(function(a){e.$$route.authenticated&&!a&&o.goTo("/entrar",r.path()),e.$$route.authPage&&a&&o.goTo("/perfil",r.path()),t(function(){s.stop(l)},800)})},n.error=function(a){s.stop(l),t(function(){s.error('<strong>VISH</strong>!<br />Isso aqui deu errado:<br />"'+a.name+'"')},1e3),o.goBack()},n}]),angular.module("rastros").factory("flow",["$filter","$location","$route","$window",function(a,e,t,r){var o={ls:r.localStorage,lastPath:null};return o.goTo=function(a,t){var r=a||"/",i=["/404","/entrar","/cadastrar","/perfil"];t=t?t:e.path(),t&&i.indexOf(t)===-1&&o.ls.setItem("lastPath",t),e.path(r)},o.goBack=function(){var a=o.ls.getItem("lastPath");e.path(a)},o.reload=function(){t.reload()},o}]),angular.module("rastros").factory("scroll",["$document",function(a){var e={};return e.toTop=function(e){var t=e||0,r=a.find("body");r.scrollTop(t,800)},e}]),angular.module("rastros").provider("moment",function(){var a;return{locale:function(e){a=e},$get:["$window",function(e){return e.moment.locale(a),e.moment}]}}),angular.module("rastros").factory("inject",["$window","config",function(a,e){var t={};return t.js=function(t,r,o){var i,s="script",n=t+"-jssdk",l=a.document,c=l.getElementsByTagName(r?r:"head")[0],d=l.getElementById(n);if(d){if("loaded"===d.readyState||"complete"===d.readyState)return;d.remove()}switch(i=l.createElement(s),i.id=n,t){case"facebook":i.src=e.FACEBOOK.SDK;break;case"accountkit":i.src=e.ACCOUNT_KIT.SDK;break;default:i.src=o?o:"none"}c.appendChild(i)},t}]),angular.module("rastros").factory("facebook",["$window","inject","config",function(a,e,t){var r={};return r.inject=function(){e.js("facebook")},r.load=function(){a.fbAsyncInit=function(){a.FB.init({appId:t.FACEBOOK.APP_ID,status:!0,cookie:!0,xfbml:!0,version:"v2.6"}),a.FB.AppEvents.logPageView()},r.inject()},r}]),angular.module("rastros").service("futliga",["$http","$q","$filter","urls",function(a,e,t,r){var o=r.CORS+r.FUTLIGA.INDEX+r.FUTLIGA.NEXT_MATCHES,i={matches:[]};return i.get=function(){var t=e.defer(),r=o;return a.get(r).then(function(a){200===a.status&&t.resolve(a.data)}).catch(function(a){t.reject(a)}),t.promise},i.nextMatches=function(){var a=e.defer();return i.get().then(function(e){a.resolve(t("futligaMatches")(e))}).catch(function(e){a.reject(e)}),a.promise},i}]),angular.module("rastros").factory("fireb",["$q",function(a){var e=firebase.database(),t={};return t.profiles={create:function(a,t){a&&t&&e.ref("profiles/"+a).set(t)},update:function(a,t){a&&t&&e.ref("profiles/"+a).update(t)},getById:function(t){var r=a.defer();return t?(e.ref("profiles/"+t).on("value",function(a){r.resolve(a.val())}),r.promise):(r.reject(),r.promise)}},t.games={create:function(a){if(a){var t={date:a.date,teams:a.teams};delete t.date.moment;var r="games/"+a.date.id+"-"+a.id;e.ref(r).set(t)}},imIn:function(a,t){if(a&&t){var r="games/"+a.date.id+"-"+a.id+"/going/"+t.uid;e.ref(r).set({confirmStamp:moment().format("YYYY-MM-DD[T]HH:mm:ss")})}},imOut:function(a,t){if(a&&t){var r="games/"+a.date.id+"-"+a.id+"/going";e.ref(r).child(t.uid).remove()}},get:function(t,r){var o=a.defer();if(!t||!r)return o.reject(),o.promise;var i="games/"+t+"-"+r;return e.ref(i).on("value",function(a){var e=a.val();return e?void o.resolve(e):void o.reject()}),o.promise}},t.teams={create:function(a){if(a){var t={futligaID:a.id,name:a.name,logo:a.logo,logoOld:a.logoOld};e.ref("teams/").push(t)}}},t}]),angular.module("rastros").factory("user",["$rootScope","$timeout","loader","flow",function(a,e,t,r){var o=firebase.auth(),i={data:null,test:{}};return i.isLogged=function(){var e=i.data;return e?(a.$broadcast("user:logged",e),e):null},i.create=function(a,i){var s="Cadastrando";t.start(s),o.createUserWithEmailAndPassword(a,i).catch(function(a){t.error(a.message)}),e(function(){r.goBack(),t.stop(s)},1e3)},i}]),angular.module("rastros").factory("authentication",["$rootScope","$document","$window","$q","fireb","user","loader","flow","config",function(a,e,t,r,o,i,s,n,l){var c=firebase.auth(),d={};return d.register=function(a,t){var r="Criando conta";s.start(r),c.createUserWithEmailAndPassword(a,t).then(function(){n.goBack(),s.stop(r)}).catch(function(a){s.stop(r),s.error('<div class="aph loader__content__error__title">Ué...</div>Alguma coisa deu errado tentando fazer seu cadastro, saca só:<br />'+a.message),e.find("body")[0].click()})},d.login=function(a,t){var r="Autenticando";s.start(r),c.signInWithEmailAndPassword(a,t).then(function(){n.goBack(),s.stop(r)}).catch(function(a){s.stop(r),s.error('<div class="aph loader__content__error__title">Ih, carai!</div>Alguma coisa deu errado tentando fazer seu login, saca só:<br />'+a.message),e.find("body")[0].click()})},d.logout=function(){var a="Saindo";s.start(a),c.signOut().then(function(){s.stop(a)},function(t){s.stop(a),s.error('<div class="aph loader__content__error__title">Óh azidéia...</div>Parece que não é pra você sair daqui, hein?!<br />Hehehe<br />Se liga no erro que deu, tentando fazer logout:<br />'+t.message),e.find("body")[0].click()})},d.facebook=function(){var a=new firebase.auth.FacebookAuthProvider;a.addScope(l.FACEBOOK.SCOPE),d.provider(a,"Facebook")},d.twitter=function(){var a=new firebase.auth.TwitterAuthProvider;d.provider(a,"Twitter")},d.provider=function(a,e){var t="Autenticando com "+e;s.start(t),c.signInWithRedirect(a)},d.resetPassword=function(a){var e=r.defer();return a?(c.sendPasswordResetEmail(a).then(function(){console.info("E-mail de redefinição de senha enviado"),e.resolve()},function(a){s.error('<div class="aph loader__content__error__title">Eita, fusão</div>Não deu pra enviar a mensagem de redefinição de senha por causa disso aqui, se liga:<br />'+a.message),
e.reject(a)}),e.promise):(console.info("Necessário um endereço de e-mail para envio da mensagem de redefinição de senha."),e.reject(),e.promise)},d._writeUserData=function(a){if(a){var e={name:a.displayName,email:a.email,emailVerified:a.emailVerified,photoURL:a.photoURL,permission:"default"};o.profiles.getById(a.uid).then(function(t){t?(delete e.permission,o.profiles.update(a.uid,e)):o.profiles.create(a.uid,e)})}},c.onAuthStateChanged(function(t){return e.find("body")[0].click(),t?(i.data=t,a.$broadcast("user:changed",i.data),void d._writeUserData(t)):(i.data=null,void a.$broadcast("user:changed",null))}),d}]),angular.module("rastros").controller("404Controller",["$scope","flow",function(a,e){a.goBack=function(){e.goBack()}}]),angular.module("rastros").controller("HomeController",["$rootScope","$scope","loader","flow","urls","futliga","fireb","user","moment",function(a,e,t,r,o,i,s,n,l){e.nextMatches=null,e.count={},e.detailsUrl=o.FUTLIGA.INDEX+o.FUTLIGA.AGENDA_PATH,e.canFillGames=!1,e.matches=function(){var a="Calendário da Futliga";t.start(a),i.nextMatches().then(function(a){e.nextMatches=a,e.saveGames(e.nextMatches)}).catch(function(e){t.error('Houve um problema com "'+a+'":<br />'+e.name)}).finally(function(){t.stop(a)})},e.updateCounts=function(t,r){var o=r.numChildren(),i=r.val();t.imGoing=!1,t.goingNumber=o||0,t.goingProfiles=[],angular.forEach(i,function(r,o){firebase.database().ref("profiles/"+o).once("value").then(function(a){var r=a.val();if(r){var o={uid:r.uid,name:r.name,photoURL:r.photoURL?r.photoURL:"/assets/images/icons/icon-60x60.png"};t.goingProfiles.push(o)}e.$apply()});var i=a.user;i&&o===i.uid&&(t.imGoing=!0)})},e.goingCount=function(a){var t="games/"+a.date.id+"-"+a.id+"/going";firebase.database().ref(t).on("value",function(t){e.updateCounts(a,t)})},e.imGoing=function(e){var t=a.user;return t?(e.imGoing=!0,void s.games.imIn(e,t)):void r.goTo("/entrar")},e.imNotGoing=function(e){var t=a.user;return t?(e.imGoing=!1,void s.games.imOut(e,t)):void r.goTo("/entrar")},e.saveGames=function(t){var r=a.user;if(t&&r)for(var o=0;o<t.length;o++){var i="games/"+t[o].date.id+"-"+t[o].id;e.verifyMatch(i,t[o])}},e.verifyMatch=function(a,e){firebase.database().ref(a).once("value").then(function(a){a.val()||s.games.create(e)})},e._canFillGames=function(a){s.profiles.getById(a).then(function(a){"root"===a.permission&&(e.canFillGames=!0)})},e.isToday=function(a){if(!a)return!1;var e=l(),t=l(a.date.year+"-"+a.date.month+"-"+a.date.day),r=!0;return e.isSameOrAfter(t)&&(r=!0),r},e.fillGame=function(a){a&&r.goTo("/jogos/"+a.date.id+"/"+a.id)},e.otherPage=function(){r.goTo("/404")},e.$on("$viewContentLoaded",function(){e.matches()}),e.$watch("user",function(){n.data&&e._canFillGames(n.data.uid)})}]),angular.module("rastros").controller("AuthController",["$rootScope","$scope","$window","$document","authentication","user","facebook","loader","flow",function(a,e,t,r,o,i,s,n,l){e.form={},e.facebook=function(){o.facebook()},e.twitter=function(){o.twitter()},e.login=function(){var a=e.form;a.email&&a.password&&o.login(a.email,a.password)},e.register=function(){var a=e.form;a.email&&a.password&&o.register(a.email,a.password)},e.forgetPassword=function(){e.form.email&&o.resetPassword(e.form.email)},e.$on("user:changed",function(a,t){e.user=t,e.user&&l.goBack()}),e.$on("$viewContentLoaded",function(){e.user=i.isLogged(),e.user&&l.goBack()})}]),angular.module("rastros").controller("ProfileController",["$scope","user","authentication",function(a,e,t){a.profile=e.data,a.linked={facebook:!1,twitter:!1,google:!1},a._verifyLinks=function(){if(a.profile){var e=a.profile.providerData;angular.forEach(e,function(e){switch(e.providerId){case"facebook.com":a.linked.facebook=!0;break;case"twitter.com":a.linked.twitter=!0;break;case"google.com":a.linked.google=!0;break;default:return!1}})}},a.facebookLink=function(){t.facebookLink()},a.$on("user:changed",function(e,t){a.profile=t,a._verifyLinks()}),a.$on("$viewContentLoaded",function(){})}]),angular.module("rastros").controller("GameController",["$rootScope","$scope","gameResolved","moment",function(a,e,t,r){e.game={},angular.extend(e.game,t),e.game.date.moment=r(t.date.timestamp),e.game.score={first:{home:{goals:[],faults:[]},visitor:{goals:[],faults:[]}},second:{home:{goals:[],faults:[]},visitor:{goals:[],faults:[]}}},e.addGoal=function(a,t){return a&&t?void e.game.score[t][a].goals.push({time:"'15",player:{name:"Udimbas",number:"02"}}):void console.info("Gol não-adicionado")},e.removeGoal=function(a,t,r){if(!a||!t||null===r)return void console.info("Gol não-removido");var o=e.game.teams[a],i=e.game.score[t][a].goals[r],s="first"===t?"Primeiro":"Segundo",n='<h3 class="aph text-red">ANULAR GOL da equipe <strong>'+o.title+"</strong>?</h3><br />"+s+' Jogo<br /><br /><i class="fa fa-fw fa-lg fa-futbol-o"></i>'+i.time+" "+i.player.name+"<br /><br />";alertify.confirm(n,function(o){o&&e.game.score[t][a].goals.splice(r,1)})},e.itemOnLongPress=function(){console.log("Long press")},e.itemOnTouchEnd=function(){console.log("Touch end")}}]),angular.module("rastros").directive("navbar",["$rootScope","$window","flow","user","authentication",function(a,e,t,r,o){return{restrict:"E",scope:!0,templateUrl:"app/templates/directives/navbar-directive-template.html",link:function(a,e){e.addClass("aph navbar navbar--fixed-top"),a.goTo=function(a){var e=a||"/";t.goTo(e)}},controller:["$scope",function(e){a.user=r.data?r.data:r.isLogged(),e.$on("user:changed",function(e,t){a.user=t}),e.logout=function(){o.logout(),t.reload()}}]}}]),angular.module("rastros").directive("errorSrc",function(){return{link:function(a,e,t){e.bind("error",function(){t.src!==t.errorSrc&&t.$set("src",t.errorSrc)})}}}),angular.module("rastros").directive("onLongPress",["$timeout",function(a){return{restrict:"A",link:function(e,t,r){t.bind("touchstart",function(){e.longPress=!0,a(function(){e.longPress&&e.$apply(function(){e.$eval(r.onLongPress)})},600)}),t.bind("touchend",function(){e.longPress=!1,r.onTouchEnd&&e.$apply(function(){e.$eval(r.onTouchEnd)})})}}}]),angular.module("rastros").filter("unsafe",["$sce",function(a){return function(e){return a.trustAsHtml(e)}}]),angular.module("rastros").filter("removeBreakLines",function(){return function(a){for(var e=a;e.match(/\r?\n|\r/);)e=e.replace(/\r?\n|\r/,"");return e}}),angular.module("rastros").filter("stringRemoveAfter",function(){return function(a,e){if(e)return e=a.indexOf(e),a.substring(0,e!==-1?e:a.length)}}),angular.module("rastros").filter("futligaMatches",["$filter",function(a){return function(e){function t(){for(var e=o.querySelectorAll(".agenda-pagina-equipe"),t=0;t<e.length;t++){var r=angular.copy(s),n=e[t].querySelector("h5"),l=e[t].querySelectorAll(".jogos-times-nome h4 a"),c=e[t].querySelector(".veja-mais").pathname;r.id=c.replace("/Agenda/","").slice(9),r.date=a("detectDate")(n.innerText),r.teams.home=a("detectTeam")(l[0]),r.teams.visitor=a("detectTeam")(l[1]),r.goingNumber=0,r.goingProfiles=null,i.push(r)}}function r(){for(var a=o.querySelectorAll("img"),e=0;e<a.length;e++)a[e].src=""}var o=document.createElement("futliga"),i=[],s={teams:{},date:{}};return o.innerHTML=e,r(),t(),i}}]),angular.module("rastros").filter("detectDate",["$filter","moment",function(a,e){return function(t){var r=a("removeBreakLines")(t).replace("     ","").replace("                     ","").replace("                ",""),o=r.slice(-19,-9),i=r.slice(-5);return o={day:o.slice(0,2),month:o.slice(3,5),year:o.slice(6,10),hour:i.slice(0,2),minute:i.slice(3,5)},o.id=o.year+o.month+o.day,o.timestamp=o.year+"-"+o.month+"-"+o.day+"T"+i+":00",o.moment=e(o.timestamp),o}}]),angular.module("rastros").filter("detectTeam",["$filter","urls",function(a,e){return function(t){var r={};return r.id=parseInt(t.href.slice(-5).replace("p","").replace("e","").replace("/","")),r.title=a("removeBreakLines")(t.innerText).replace("                            ","").replace("                        ",""),r.logoOld=e.FUTLIGA.INDEX+e.FUTLIGA.IMAGES_PATH+r.id+".gif",r.logo=e.FUTLIGA.INDEX+e.FUTLIGA.IMAGES_PATH+r.id+"-v01.gif",r}}]);