"use strict";angular.module("rastros",["ngRoute","ngAnimate","duScroll"]),angular.module("rastros").config(["$locationProvider","$routeProvider","momentProvider",function(t,e,a){a.locale("pt-br"),e.when("/",{templateUrl:"app/templates/home-template.html",controller:"HomeController"}).when("/404",{templateUrl:"app/templates/404-template.html",controller:"404Controller"}).when("/meu/login",{templateUrl:"app/templates/auth-login-template.html",controller:"LoginController",authPage:!0}).when("/meu/cadastro",{templateUrl:"app/templates/auth-register-template.html",controller:"RegisterController",authPage:!0}).when("/meu/perfil",{templateUrl:"app/templates/garage/garage-template.html",controller:"ProfileController",authenticated:!0}).otherwise({redirectTo:"/404"})}]),angular.module("rastros").run(["$rootScope","routeChange",function(t,e){t.$on("$routeChangeError",e.error),t.$on("$routeChangeStart",e.start),t.$on("$routeChangeSuccess",e.success)}]),function(){angular.module("rastros").run(["$templateCache",function(t){t.put("app/templates/404-template.html",'<header class="header bg-light-blue"> <container> <h1 class="title"> 404 </h1> </container> </header> <section class="section"> <container> <h2> Page not found </h2> <br> <button class="button softed" data-ng-click="goBack()"> Back </button> </container> </section>'),t.put("app/templates/auth-login-template.html",'<header class="header"> <container> <h1 class="header__title"> Login </h1> </container> </header> <section class="section"> <container> <div class="row"> <div class="col-lg-4 col-md-6 col-sm-12"> <h2 class="section__title"> Seus dados </h2> <form class="form form--vertical" data-ng-submit="login()"> <div class="form__field"> <label class="form__label" for="email"> E-mail: </label> <input class="form__control" type="email" name="email" id="email" required placeholder="voce@exemplo.com" data-ng-model="form.email"> </div> <div class="form__field"> <label class="form__label" for="password"> Senha: </label> <input class="form__control" type="password" id="password" required placeholder="**************" data-ng-model="form.password"> </div> <div class="form__field"> <button class="form__button button wide" type="submit" data-ng-disabled="!form.email || !form.password"> LOGIN </button> </div> <div class="form__field"> OU ENTÃO </div> <div class="form__field"> <button class="form__button button wide" type="button" data-ng-click="facebookLogin()"> ENTRAR COM O FACEBOOK </button> </div> </form> </div> <div class="col-lg-4"></div> <div class="col-lg-4 col-md-6 col-sm-12"> <h2 class="section__title"> Não tem cadastro? </h2> <button class="button green" data-ng-click="goToRegister()"> FAZ UM RÁPIDÃO </button> </div> </div> </container> </section>'),t.put("app/templates/auth-register-template.html",'<header class="header"> <container> <h1 class="header__title"> <span data-ng-show="!user"> Cadastre-se </span> <span data-ng-show="user"> Salve, {{ user.name || user.email }}! </span> </h1> </container> </header> <section class="section"> <container data-ng-show="!user"> <form> <form-field> <input type="email" required placeholder="voce@exemplo.com" data-ng-model="form.email"> </form-field> <form-field> <input type="password" required placeholder="**************" data-ng-model="form.password"> </form-field> <form-field> <button type="button" data-ng-click="register()"> CADASTRAR </button> </form-field> </form> <h2 class="section__title"> Já é cadastrado? </h2> <button data-ng-click="goToLogin()"> FAÇA LOGIN </button> </container> <container data-ng-show="user"> <div data-ng-bind="user.email"></div> </container> </section>'),t.put("app/templates/home-template.html",'<section class="section"> <container> <h1 class="section__title"> Próximas Partidas </h1> <div class="card match" data-ng-repeat="match in nextMatches"> <div class="match__teams"> <figure class="match__team"> <img class="match__team__logo" data-ng-src="{{ match.opponent.logo }}" alt="{{ match.opponent.title }}"> <legend class="match__team__title"> {{ match.opponent.title }} </legend> </figure> <div class="match__versus">×</div> <figure class="match__team"> <img class="match__team__logo" data-ng-src="./assets/images/os-rastros.gif" alt="Os Rastros"> <legend class="match__team__title"> Os Rastros </legend> </figure> </div> <div class="match__details"> <div class="match__details__item"> <i class="fa fa-fw fa-list match__details__item__icon"></i> <strong>DETALHES</strong> </div> <div class="match__details__item"> <i class="fa fa-fw fa-calendar match__details__item__icon"></i> {{ match.date.formatted }} </div> <div class="match__details__item"> <i class="fa fa-fw fa-clock-o match__details__item__icon"></i> {{ match.date.time }}, bola rolando </div> <div class="match__details__item"> <i class="fa fa-fw fa-map-marker match__details__item__icon"></i> {{ match.location.stadium }} </div> </div> </div> </container> </section> '),t.put("app/templates/directives/loader-directive-template.html",'<div class="loader" data-ng-hide="activities.length === 0 && errors.length === 0"> <div class="loader__content"> <div class="venus container"> <figure class="loader__content__spinner" data-ng-show="activities.length !== 0 && errors.length === 0"> <img class="loader__content__spinner__image" data-ng-src="./assets/images/loader--spinner.gif" alt="Loading"> </figure> <div class="loader__content__message" data-ng-repeat="activity in activities"> <div data-ng-if="!activity.title && !activity.text" data-ng-bind-html="activity | unsafe"> </div> <div class="loader__content__message__title" data-ng-if="activity.title" data-ng-bind-html="activity.title | unsafe"> </div> <div class="loader__content__message__text" data-ng-if="activity.text" data-ng-bind-html="activity.text | unsafe"> </div> </div> <div class="loader__content__error" data-ng-repeat="error in errors"> <div data-ng-bind-html="error | unsafe"></div> <button class="loader__content__error__icon" data-ng-click="clearError(error)"> <i class="fa fa-times"></i> </button> </div> </div> </div> </div> '),t.put("app/templates/directives/navbar-directive-template.html",'<nav class="navbar navbar--fixed-top navbar--inverted"> <container> <div class="navbar-nav"> <button class="navbar-menu-toggle"> <i class="fa fa-fw fa-bars"></i> </button> <a class="navbar-brand" data-ng-click="goTo(\'/\')" title="Início"> <img class="navbar-brand-logo" width="32" height="32" data-ng-src="./assets/images/icons/icon-32x32.png" src="./assets/images/icons/icon-32x32.png"> Os Rastros </a> <ul class="navbar-menu list"> <!-- \n\t\t\t\t<li class="list-item">\n\t\t\t\t\t<a class="list-item-link"\n\t\t\t\t\t   data-ng-click="goTo(\'/help\')">\n\t\t\t\t\t   <i class="fa fa-fw fa-question-circle-o"></i>\n\t\t\t\t\t\tAjuda\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t\t--> <li class="list-item" data-ng-show="user"> <img class="navbar-menu-user-avatar" height="32" width="32" data-ng-src="user.photoURL" data-ng-if="user.photoURL"> <a class="list-item-link navbar-menu-user dropdown-toggle" data-ng-click="goTo(\'/meu/cadastro\')" data-ng-bind="user.name || user.email" title="Ver seu cadastro"> </a> </li> <li class="list-item" data-ng-hide="user"> <a class="list-item-link" data-ng-click="goTo(\'/meu/login\')"> <i class="fa fa-fw fa-sign-in"></i> Login </a> </li> <li class="list-border"></li> <li class="list-item" data-ng-hide="user"> <a class="button" data-ng-click="goTo(\'/meu/cadastro\')"> <i class="fa fa-fw fa-user-plus"></i> Cadastro </a> </li> <li class="list-item" data-ng-show="user"> <a class="list-item-link" data-ng-click="logout()" title="Sair"> <i class="fa fa-fw fa-power-off"></i> </a> </li> </ul> <!-- \n\t\t\t<button class="navbar-menu-settings">\n\t\t\t\t<i class="fa fa-fw fa-ellipsis-v"></i>\n\t\t\t</button>\n\t\t\t--> </div> </container> </nav> '),t.put("app/templates/directives/loader-directive-template.html",'<div class="loader" data-ng-hide="activities.length === 0 && errors.length === 0"> <div class="loader__content"> <div class="venus container"> <figure class="loader__content__spinner" data-ng-show="activities.length !== 0 && errors.length === 0"> <img class="loader__content__spinner__image" data-ng-src="./assets/images/loader--spinner.gif" alt="Loading"> </figure> <div class="loader__content__message" data-ng-repeat="activity in activities"> <div data-ng-if="!activity.title && !activity.text" data-ng-bind-html="activity | unsafe"> </div> <div class="loader__content__message__title" data-ng-if="activity.title" data-ng-bind-html="activity.title | unsafe"> </div> <div class="loader__content__message__text" data-ng-if="activity.text" data-ng-bind-html="activity.text | unsafe"> </div> </div> <div class="loader__content__error" data-ng-repeat="error in errors"> <div data-ng-bind-html="error | unsafe"></div> <button class="loader__content__error__icon" data-ng-click="clearError(error)"> <i class="fa fa-times"></i> </button> </div> </div> </div> </div> '),t.put("app/templates/directives/navbar-directive-template.html",'<nav class="navbar navbar--fixed-top navbar--inverted"> <container> <div class="navbar-nav"> <button class="navbar-menu-toggle"> <i class="fa fa-fw fa-bars"></i> </button> <a class="navbar-brand" data-ng-click="goTo(\'/\')" title="Início"> <img class="navbar-brand-logo" width="32" height="32" data-ng-src="./assets/images/icons/icon-32x32.png" src="./assets/images/icons/icon-32x32.png"> Os Rastros </a> <ul class="navbar-menu list"> <!-- \n\t\t\t\t<li class="list-item">\n\t\t\t\t\t<a class="list-item-link"\n\t\t\t\t\t   data-ng-click="goTo(\'/help\')">\n\t\t\t\t\t   <i class="fa fa-fw fa-question-circle-o"></i>\n\t\t\t\t\t\tAjuda\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t\t--> <li class="list-item" data-ng-show="user"> <img class="navbar-menu-user-avatar" height="32" width="32" data-ng-src="user.photoURL" data-ng-if="user.photoURL"> <a class="list-item-link navbar-menu-user dropdown-toggle" data-ng-click="goTo(\'/meu/cadastro\')" data-ng-bind="user.name || user.email" title="Ver seu cadastro"> </a> </li> <li class="list-item" data-ng-hide="user"> <a class="list-item-link" data-ng-click="goTo(\'/meu/login\')"> <i class="fa fa-fw fa-sign-in"></i> Login </a> </li> <li class="list-border"></li> <li class="list-item" data-ng-hide="user"> <a class="button" data-ng-click="goTo(\'/meu/cadastro\')"> <i class="fa fa-fw fa-user-plus"></i> Cadastro </a> </li> <li class="list-item" data-ng-show="user"> <a class="list-item-link" data-ng-click="logout()" title="Sair"> <i class="fa fa-fw fa-power-off"></i> </a> </li> </ul> <!-- \n\t\t\t<button class="navbar-menu-settings">\n\t\t\t\t<i class="fa fa-fw fa-ellipsis-v"></i>\n\t\t\t</button>\n\t\t\t--> </div> </container> </nav> ')}])}(),function(t,e){"object"==typeof exports&&"undefined"!=typeof module&&"function"==typeof require?e(require("../moment")):"function"==typeof define&&define.amd?define(["../moment"],e):e(t.moment)}(this,function(t){var e=t.defineLocale("pt-br",{months:"Janeiro_Fevereiro_Março_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Terça-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sábado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sáb".split("_"),weekdaysMin:"Dom_2ª_3ª_4ª_5ª_6ª_Sáb".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [às] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [às] HH:mm"},calendar:{sameDay:"[Hoje às] LT",nextDay:"[Amanhã às] LT",nextWeek:"dddd [às] LT",lastDay:"[Ontem às] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[Último] dddd [às] LT":"[Última] dddd [às] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrás",s:"poucos segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinalParse:/\d{1,2}º/,ordinal:"%dº"});return e}),angular.module("rastros").constant("urls",{BRANDS:"http://usa1.simsdev.info/api/marcas/"}),angular.module("rastros").provider("moment",function(){var t;return{locale:function(e){t=e},$get:["$window",function(e){return e.moment.locale(t),e.moment}]}}),angular.module("rastros").factory("routeChange",["$rootScope","$document","$timeout","flow","scroll","loader",function(t,e,a,r,n,i){var o={},s=e.find("content"),l="Trampando...";return o.start=function(){i.start(l),s.addClass("loading")},o.success=function(){n.toTop(),a(function(){s.removeClass("loading"),i.stop(l)},800)},o.error=function(t){a(function(){i.error('<strong>VISH</strong>!<br />Isso aqui deu errado:<br />"'+t.name+'"')},1e3),r.goBack()},o}]),angular.module("rastros").factory("flow",["$filter","$location","$route",function(t,e,a){var r={lastPath:null};return r.goTo=function(t,a){var n=t||"/",i=["/404","/login","/register"];a=a?a:e.path(),i.indexOf(a)===-1&&(r.lastPath=a),e.path(n)},r.goBack=function(){var t=r.lastPath||"/";e.path(t)},r.reload=function(){a.reload()},r}]),angular.module("rastros").factory("loader",["$timeout",function(t){var e={activities:[],errors:[]};return e.start=function(t){if(e.activities.indexOf(t)===-1)return e.activities.push(t),!0},e.stop=function(a){t(function(){for(var t in e.activities)e.activities[t]===a&&e.activities.splice(t,1)},100)},e.error=function(t,a){e.errors.push(t),a&&console.error(a)},e.clearError=function(t){for(var a in e.errors)e.errors[a]===t&&e.errors.splice(a,1)},e}]),angular.module("rastros").factory("scroll",["$document",function(t){var e={};return e.toTop=function(e){var a=e||0,r=t.find("body");r.scrollTop(a,800)},e}]),angular.module("rastros").service("futliga",["$http","$q","$filter",function(t,e,a){var r="https://cors-anywhere.herokuapp.com/",n=r+"https://futliga.com.br/",i={matches:[]};return i.get=function(){var a=e.defer(),r=n+"futliga/associado/equipes/associado-equipes-obter-agenda.asp?codigo=8985";return t.get(r).then(function(t){200===t.status&&a.resolve(t.data)}).catch(function(t){a.reject(t)}),a.promise},i.nextMatches=function(){var t=e.defer();return i.get().then(function(e){t.resolve(a("futligaMatches")(e))}).catch(function(e){t.reject(e)}),t.promise},i}]),angular.module("rastros").factory("fireb",["$q","loader",function(t,e){var a=firebase.database(),r={};return r.create=function(t){if(t){var r="Cadastrando";e.start(r);var n=a.ref().child("users").push().key;a.ref("users/"+n).set(t).then(function(){e.stop(r)}).catch(function(t){e.error(t)})}},r.getById=function(e){if(e){var r=t.defer();return a.ref("/users/"+e).once("value").then(function(t){r.resolve(t.val())}).catch(function(t){r.reject(t)}),r.promise}},r}]),angular.module("rastros").factory("user",["$rootScope","$timeout","fireb","loader","flow",function(t,e,a,r,n){var i=(firebase.auth(),{data:null});return i.isLogged=function(){var e=i.data;return e?(t.$broadcast("user:logged",e),e):null},i.create=function(t,a){var i="Cadastrando";r.start(i),firebase.auth().createUserWithEmailAndPassword(t,a).catch(function(t){r.error(t.message)}),e(function(){n.goBack(),r.stop(i)},1e3)},i}]),angular.module("rastros").factory("auth",["$rootScope","$q","fireb","user","loader","flow",function(t,e,a,r,n,i){var o=firebase.auth(),s={};return s.login=function(t,e){var a="Autenticando";n.start(a),o.signInWithEmailAndPassword(t,e).then(function(){i.goBack(),n.stop(a)}).catch(function(t){n.error(t.message)})},s.logout=function(){var t="Saindo";n.start(t),o.signOut().then(function(){n.stop(t)},function(t){n.error(t.message)})},s.facebookLogin=function(){var e="Autenticando com Facebook",a=new firebase.auth.FacebookAuthProvider;n.start(e);var i=o.signInWithRedirect(a);console.log(i),o.getRedirectResult().then(function(a){var i=a.credential?a.credential.accessToken:null,o=a.user;console.log(o),r.data=o.providerData[0],r.data.fbToken=i,t.$broadcast("user:changed",r.data),n.stop(e)}).catch(function(e){var a=e.code,r=e.message,i=e.email;e.credential;t.$broadcast("user:changed",null),n.error(a+": "+r+"<br />("+i+")")})},o.onAuthStateChanged(function(e){return e?(r.data=e.providerData[0],void t.$broadcast("user:changed",r.data)):(r.data=null,void t.$broadcast("user:changed",null))}),s}]),angular.module("rastros").controller("404Controller",["$scope","flow",function(t,e){t.goBack=function(){e.goBack()}}]),angular.module("rastros").controller("HomeController",["$scope","loader","flow","futliga",function(t,e,a,r){t.matches=function(){var a="Calendário da Futliga";e.start(a),r.nextMatches().then(function(e){t.nextMatches=e}).catch(function(t){e.error('Houve um problema com "'+a+'":<br />'+t.name)}).finally(function(){e.stop(a)})},t.otherPage=function(){a.goTo("/404")},t.$on("$viewContentLoaded",function(){t.matches()})}]),angular.module("rastros").controller("LoginController",["$scope","auth","user","fireb","flow",function(t,e,a,r,n){t.form={},t.login=function(){var a=t.form;a.email&&a.password&&e.login(a.email,a.password)},t.facebookLogin=function(){e.facebookLogin()},t.goToRegister=function(){n.goTo("/meu/cadastro")},t.$on("user:changed",function(e,a){t.user=a,t.user&&n.goBack()}),t.$on("$viewContentLoaded",function(){t.user=a.isLogged(),t.user&&n.goBack()})}]),angular.module("rastros").controller("RegisterController",["$scope","user","fireb","flow",function(t,e,a,r){t.form={},t.register=function(){var a=t.form;a.email&&a.password&&e.create(a.email,a.password)},t.goToLogin=function(){r.goTo("/meu/login")},t.$on("user:changed",function(e,a){t.user=a}),t.$on("$viewContentLoaded",function(){t.user=e.isLogged()})}]),angular.module("rastros").directive("loader",["loader",function(t){return{restrict:"E",templateUrl:"app/templates/directives/loader-directive-template.html",scope:{},link:function(e){e.activities=t.activities,e.errors=t.errors,e.clearError=function(e){t.clearError(e)}}}}]),angular.module("rastros").directive("navbar",["flow","user","auth",function(t,e,a){return{restrict:"E",scope:!0,templateUrl:"app/templates/directives/navbar-directive-template.html",link:function(e){e.logout=function(){a.logout()},e.goTo=function(e){var a=e||"/";t.goTo(a)}},controller:["$scope",function(t){t.user=e.data?e.data:e.isLogged(),t.$on("user:changed",function(e,a){t.user=a})}]}}]),angular.module("rastros").filter("unsafe",["$sce",function(t){return function(e){return t.trustAsHtml(e)}}]),angular.module("rastros").filter("removeBreakLines",function(){return function(t){for(var e=t;e.match(/\r?\n|\r/);)e=e.replace(/\r?\n|\r/,"");return e}}),angular.module("rastros").filter("stringRemoveAfter",function(){return function(t,e){if(e)return e=t.indexOf(e),t.substring(0,e!==-1?e:t.length)}}),angular.module("rastros").filter("futligaMatches",["$filter","moment",function(t,e){return function(a){function r(t){if(t){var e=i.querySelectorAll("img"),a="https://futliga.com.br/imagens/distintivos/";for(var r in e){var n=e[r];if(n.src&&n.src.includes("/distintivos/"+t))return a+t+".gif"}return a+"0.jpg"}}function n(){var a=i.querySelectorAll('div[style="float: left; margin: 10px 5px 10px 5px; width: 540px;"]');for(var n in a){var l=a[n];if(l&&!angular.isFunction(l)&&!angular.isNumber(l)){var c=l.nextElementSibling;if(c.querySelector(".liga-link9")){var d,u,m,f,g,p,v,h,_,b={},w=angular.copy(s);f=c.querySelector('span[style="font-size: 30px;"]').innerText,l=l.querySelector('div[style="float: right; width: 50%; text-align: right;"]').innerText,l=l.replace("                            ",""),l=l.replace("                        ",""),l=t("removeBreakLines")(l),l=l.replace("Semana ",""),g=parseInt(l.slice(0,2)),v=parseInt(l.slice(3,7)),p=c.querySelector('span[style="color: #000000; font-size: 10px; text-transform: uppercase;"]').textContent,u=c.querySelectorAll('div[style="float: left; width: 300px; top: inherit; text-align: left;"]')[1],_=u.querySelector(".liga-link8").textContent,_=_.replace("                                                ",""),_=_.replace("                                            ",""),_=t("removeBreakLines")(_),u=u.innerHTML,u=t("stringRemoveAfter")(u,"&nbsp;-&nbsp;"),u=u.replace("                                            ",""),u=t("removeBreakLines")(u),m=u.slice(3,5),u=u.slice(0,2),d=e().year(v).week(g+2),d.day(t("weekDay")(p)),d.hour(u),d.minute(m),d.second(0),w.date.time=u+":"+m,w.date.day=f,w.date.weekDay=p,w.date.moment=d,w.date.formatted=d.format("dddd, DD [de] MMMM"),w.location.stadium=_,h=c.querySelector(".liga-link9"),b.title=h.innerText,b.title=t("removeBreakLines")(b.title),b.title=b.title.replace("                                                ",""),b.title=b.title.replace("                                            ",""),b.id=h.attributes.href.textContent,b.id=b.id.replace(")",""),b.id=parseInt(b.id.replace("javascript:DetalharEquipe(","")),b.logo=r(b.id),w.opponent=b,o.push(w)}}}}var i=document.createElement("futliga"),o=[],s={opponent:null,date:{},location:{stadium:null,street:null,number:null,zone:null,city:"São Paulo",state:"SP"}};return i.innerHTML=a,n(i,o),o}}]),angular.module("rastros").filter("weekDay",function(){return function(t){var e;switch(t){case"Segunda":e="Monday";break;case"Terça":e="Tuesday";break;case"Quarta":e="Wednesday";break;case"Quinta":e="Thursday";break;case"Sexta":e="Friday";break;case"Sábado":e="Saturday";break;default:e="Monday"}return e}});